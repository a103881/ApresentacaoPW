<!DOCTYPE html>
<html lang="pt">
  <head>
    <title>Danificação Acidental de Exposição</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
	<link href="https://fonts.googleapis.com/css2?family=Orelega+One&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Days+One&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <link rel="stylesheet" href="../css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.css">
    
    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/magnific-popup.css">

    <link rel="stylesheet" href="../css/aos.css">

    <link rel="stylesheet" href="../css/ionicons.min.css">

    <link rel="stylesheet" href="../css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="../css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="../css/flaticon.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/floatingwindow.css">
  </head>
   
  <body>
    <header class="header">
        <div class="logo">
        <img src="images/logo.png" alt="Logo" class="logo-img">
        <h1>EyesEverywhere</h1> <!-- Nome da Marca -->
      </div>
      <div class="nav">
        <a href="frontoffice_ms/index.html" class="btn-home">Página Principal</a> <!-- Botão Home Page -->
      </div>
       </header>

	<div id="colorlib-page">
		<a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle"><i></i></a>
		<aside id="colorlib-aside" role="complementary" class="js-fullheight">

			<!-- INFO BOX PRIMEIRO -->
			<div class="info-box">
			  <p class="numero">379</p>
			  <p class="descricao">Auditorias Realizadas</p>
		  
			  <p class="numero">364</p>
			  <p class="descricao">Ocorrências Resolvidas</p>
		  
			  <p class="numero">2H</p>
			  <p class="descricao">Tempo Médio de Resposta</p>
		  
			  <p class="numero">96%</p>
			  <p class="descricao">Satisfação dos Clientes</p>
			</div>
		  
			<!-- MENU NAVEGAÇÃO -->
			<nav id="colorlib-main-menu" role="navigation">
			</nav>
		  
			<!-- BOTÕES -->
			<div class="btn-container">
        <a href="#" id="abrirModal" class="btn-criar-ocorrencia">Criar Ocorrência</a>
        <a href="https://mail.google.com/mail/?view=cm&fs=1&to=renato.goncalvesc@gmail.com&su=Fale%20Connosco&body=Olá," target="_blank" class="btn-fale-connosco">
          Fale Connosco <i class="fa fa-comment"></i>
        </a>
        
      </div>
    </aside>
    
		<div id="colorlib-main">
  <section class="ftco-section ftco-no-pt ftco-no-pb">
    <div class="container-fluid">
      <div class="row no-gutters">
        <div class="col px-md-5 py-5">
          <div class="row pt-md-4" style="text-align: justify;">
            <div class="meta-wrap">
              <button class="btn-indicador">Aberto</button>
              <div class="container">
                <div id="detalhes-ocorrencia"></div>
              </div>
                <script>
                  const params = new URLSearchParams(window.location.search);
                  const id = params.get('id');

                  const container = document.getElementById('detalhes-ocorrencia');
                  const dadosIniciais = JSON.parse(localStorage.getItem("dadosOcorrencias")) || {};
                  const userId = localStorage.getItem('googleUserId');

                  if (id && dadosIniciais[id]) {
                    const o = dadosIniciais[id];

                    if (o.googleUserId === userId) {
                      container.innerHTML = `
                        <h1>${o.titulo}</h1>
                        <p><strong>Morada:</strong> ${o.morada || ''}</p>
                        <p><strong>Tipo:</strong> ${o.tipo || ''}</p>
                        <p><strong>Descrição:</strong> ${o.descricao || ''}</p>
                        <p><strong>Relatório:</strong> ${o.relatorio || 'Sem relatório'}</p>
                        <p><strong>Comentários:</strong> ${o.comentarios || 'Sem comentário'}</p>
                        ${o.anexo ? `<img src="${o.anexo.startsWith('data:image') ? o.anexo : 'data:image/jpeg;base64,' + o.anexo}" alt="Imagem da Ocorrência" style="max-width:100%;margin-top:10px;" />` : ''}
                      `;
                    } else {
                      container.innerHTML = "<p>Não tens permissão para visualizar esta ocorrência.</p>";
                    }
                  } else {
                    container.innerHTML = "<p>Ocorrência não encontrada.</p>";
                  }
                </script>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

  <script src="../js/floatingwindow.js"></script>

  </body>
</html>
